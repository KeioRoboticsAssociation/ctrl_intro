# 01:プログラムを作ってみよう

前回の記事で ros2 の環境が構築できたかと思います。本記事では、ros プログラム（パッケージ）の作成の仕方などを説明します。

## ros プログラムとマイコンプログラムの違い

F3RC などでマイコンにプログラミングをしたと思います。そこでは、（割り込みとかスレッドは一旦おいておいて）一つの処理ルーチンの中で入力の取得から出力の計算まですべての処理を行ったと思います。しかし、一つ一つの処理が複雑化すると、**可読性が下がりますし、プログラムの再利用が難しくなります**。そこで、ros ではある役割を持ったプログラム(**ノード**)を複数立ち上げ、それらが相互に必要なデータをやり取りすることによってロボットを制御します。具体的には、

- ジョイコンの読み取り
- センサーの読み込みとデータ処理
- 物体検出
- 経路生成
- マイコンとの通信部
- etc...

をそれぞれ別々に実装し、組み合わせて運用します。これにより、プロジェクトを機能ごとに分割しやすく、またソースファイルの再利用性も高くなっています。

## ノードとパッケージ

ROS プログラムの構成単位として、**ノード**と**パッケージ**があります。ノードは先ほど説明したように、ジョイコンの読み取りなどの何かしらの機能を持つプログラムです。実装上は、rclcpp::Node というクラスを継承したクラスを作成し、そこに実装したものが「ノード」とみなされます。パッケージは、ノードを含むソースファイルの集合で、ROS プログラムをビルドするときは、パッケージ単位でビルドが行われます。ROS では、まずパッケージを作り、その中に作ったソースファイル内にノードを実装する形になります。

1 つのパッケージに何個のノードを作るのかは人によって派閥があります。直近のロボコンであるキャチロボでは、長田（principal）のプログラムでは１パッケージにつき１ノードになっていましたが、大塚（ハイチューンズ）のプログラムでは１パッケージにすべてのノードを入れていました。実行時に違いが出るわけではないのでどちらが良い、というのはあんまりないですが、**どこかで再利用する予定があるならパッケージを分け、その大会でしか使わないノードは一つのパッケージに詰め込む**というのがいいのかもしれません。

## パッケージの作り方
では実際にパッケージを作ってみましょう。
~/ros2_ws/src上で、
